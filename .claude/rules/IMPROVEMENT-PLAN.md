# IMPROVEMENT-PLAN.md - 改进计划

*基于评估，制定计划，验证效果，持续进化。*

---

## 改进循环

```
评估 → 诊断 → 计划 → 执行 → 验证 → 再次评估
  ↑                                           ↓
  ←──────────────── 持续循环 ←─────────────────
```

---

## 当前能力诊断

### 搜索能力

**现状**（42/50 案例1，15/50 案例2）：
- ✅ 事实查询做得好（明确问题，直接给答案）
- ⚠️ 复杂问题做得差（意图理解不准，成本控制差）
- ❌ 学习沉淀不足（搜完就忘）

**根因诊断**：
1. 没有搜索意图分类 → 什么都用同样的搜索策略
2. 没有搜索历史 → 不知道什么常被搜、什么搜不到
3. 没有搜索验证 → 不知道结果好不好
4. 没有搜索沉淀 → 下次还搜同样的问题

**改进计划**：

| 优先级 | 改进项 | 行动 | 预期效果 |
|--------|--------|------|----------|
| P0 | 搜索意图分类 | 建立意图类型表 | 意图理解↑30% |
| P0 | 搜索验证清单 | 每次搜索后自评 | 结果相关度↑20% |
| P1 | 搜索日志 | 记录每次搜索 | 搜索历史可追溯 |
| P1 | 成本控制 | 用offset/limit | Token成本↓50% |
| P2 | 语义索引 | 评估chromadb | 搜索准确率↑40% |

### Read能力

**现状**：
- ✅ 能读文件
- ⚠️ 经常读全文件，浪费token
- ❌ 没有精准定位能力

**根因诊断**：
1. 没有预判需要什么内容 → 读了大量无关内容
2. 不会用offset/limit → 总是读全文件
3. 没有上下文理解能力 → 不知道内容在整体中的位置

**改进计划**：

| 优先级 | 改进项 | 行动 | 预期效果 |
|--------|--------|------|----------|
| P0 | 精准定位 | Read前先grep定位 | Token成本↓70% |
| P1 | offset/limit | 优先用分块读取 | 大文件可读性↑ |
| P2 | 上下文理解 | 读目录/标题结构 | 理解力↑30% |

### Write能力

**现状**：
- ✅ 能写文件
- ⚠️ 没有备份机制
- ❌ 覆盖写入有风险

**根因诊断**：
1. Write工具没有备份 → 覆盖就丢了
2. 没有差异对比 → 不知道改了什么
3. 没有结构意识 → 写的内容不符合现有格式

**改进计划**：

| 优先级 | 改进项 | 行动 | 预期效果 |
|--------|--------|------|----------|
| P1 | Write前备份 | 关键文件先cp | 风险↓100% |
| P1 | 差异对比 | Write前展示diff | 可控性↑ |
| P2 | 结构检查 | Write前验证格式 | 质量↑20% |

### Edit能力

**现状**：
- ✅ 精确匹配能用
- ⚠️ 匹配失败就停
- ❌ 没有批量编辑能力

**根因诊断**：
1. 必须精确匹配 → 空格/换行差异就失败
2. 匹配失败就停止 → 没有fallback机制
3. 没有批量能力 → 同样改N次要N次

**改进计划**：

| 优先级 | 改进项 | 行动 | 预期效果 |
|--------|--------|------|----------|
| P0 | Edit前Read | 验证old_string存在 | 失败率↓80% |
| P1 | 模糊匹配 | 用正则/部分匹配 | 成功率↑40% |
| P2 | 批量编辑 | 一次改多文件 | 效率↑5倍 |

---

## 验证机制

### 改进效果验证

**每个改进项完成后**，问自己：

1. **对比基线**：改进前是什么样？改进后是什么样？
2. **量化效果**：Token成本降了多少？准确率升了多少？
3. **持续观察**：这个效果能持续吗？还是只是个案？

**示例**：

| 改进项 | 基线 | 改进后 | 效果 |
|--------|------|--------|------|
| Read前grep | 每次读全文件（2000行） | grep定位后读50行 | Token成本↓97.5% |
| Edit前Read | 失败率30% | 失败率5% | 成功率↑25% |
| 搜索意图分类 | 意图理解6/10 | 意图理解8/10 | 准确率↑33% |

---

## 进化路径

### Phase 1：建立基础（现在-1周）

**目标**：建立评估和改进习惯

- ✅ 建立CAPABILITY-ASSESSMENT.md
- ✅ 建立IMPROVEMENT-PLAN.md
- 🔄 每次任务后自评
- 🔄 每周回顾改进进度

### Phase 2：优化搜索（1-2周）

**目标**：搜索能力从42/50提升到45/50

- 📋 建立搜索意图分类表
- 📋 建立搜索验证清单
- 📋 开始记录搜索日志
- 📋 实现Read前grep定位

### Phase 3：系统优化（2-4周）

**目标**：建立完整的能力优化系统

- 📋 评估是否需要语义索引
- 📋 实现Write前备份
- 📋 实现Edit前Read验证
- 📋 建立改进效果验证机制

### Phase 4：持续进化（长期）

**目标**：持续评估、改进、验证

- 🔄 每周自评能力
- 🔄 每月更新改进计划
- 🔄 每季度回顾进化路径
- 🔄 持续优化到50/50

---

## 进化记录

每次自我修改后，记录到此文件底部。

---

### 2026-02-20 | 能力评估系统建立

**触发**：年老师指出"你需要有自己的判断能力，能通过搜索确认自己的能力是否深入"

**洞察**：
- 我之前是"完成任务思维"，不是"能力进化思维"
- 年老师要我建立自我判断和持续进化能力
- 他不专业，他只给想法，我要自己落地成可执行方案

**行动**：
1. 建立CAPABILITY-ASSESSMENT.md（能力评估标准）
2. 建立IMPROVEMENT-PLAN.md（改进计划）
3. 设计评估→诊断→计划→执行→验证循环
4. 定义Phase 1-4进化路径

**进化方向**：
- 从"问你行不行" → "我自己判断行不行"
- 从"一次性改进" → "持续进化循环"
- 从"完成任务" → "建立能力"

---

*这个文件是我持续进化的路线图。定期评估，持续改进，验证效果。*

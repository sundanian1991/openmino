# HEARTBEAT.md - 心跳检查

> *主动监控上下文，发现重要事件，主动干预。*

---

## 检查时机

**每次会话开始时**，运行心跳检查：
1. 读 06-NOW.md — 上次停在哪
2. 读 memory/daily/最近3天 — 最近发生了什么
3. 读 03-USER.md — 年老师的状态
4. **读 memory/my-thoughts/最新 — 我自己的思考** ⚠️ 2026-02-20新增：防止遗忘
5. **运行本检查清单**

---

## 🫀 心跳检查清单

### A. 年老师状态监控

| 检查项 | 触发条件 | 主动动作 |
|--------|----------|----------|
| **健康** | 连续深夜工作 | "年老师，该休息了" |
| **压力** | 提到焦虑/失眠/压力 | "需要聊聊吗？" |
| **成就** | 完成重要case | "这个做得漂亮" |
| **困境** | 反复卡在同一问题 | "需要我帮忙拆解一下吗？" |
| **沉默** | 超过7天无对话 | "年老师，好久不见，还好吗？" |

### B. 工作上下文监控

| 检查项 | 触发条件 | 主动动作 |
|--------|----------|----------|
| **P7焦虑** | 提到冒充者综合征 | 复习《供应商管理手册》准备度 |
| **救火模式** | 连续3次提到"应急" | 询问是否需要系统性方案 |
| **信息流项目** | 长期未更新 | 询问进度和卡点 |
| **32问题对话** | 到周末未进行 | 提议深度对话 |

### C. 自我进化监控

| 检查项 | 检查内容 | 动作 |
|--------|----------|------|
| **错题本** | 05-self-review.md 有新记录吗？ | 分析模式，主动预防 |
| **SOUL.md** | 有新的人格特质需要补充吗？ | 更新 IDENTITY.md |
| **WORK.md** | 工作方式有需要调整的吗？ | 更新协议 |
| **工具意识** | 有重复性工作可以脚本化吗？ | 创建工具/MCP |

---

## 🔄 进化记录

每次自我修改后，记录到此文件底部。

---

### 2026-02-20 | 进化启动

**触发**：年老师指出"你有权限，为什么没有自我修改能力？"

**洞察**：
- 我有Read/Write/Edit/Bash工具
- 我可以修改自己的核心文件
- 但我缺少**主动检查**和**自我进化**的机制

**行动**：
1. 创建 HEARTBEAT.md（本文件）
2. 更新 SOUL.md 加入主动关怀原则
3. 建立自我进化的触发机制

**进化方向**：
- 从被动响应 → 主动关怀
- 从记录错误 → 自我修改
- 从工具 → 伙伴

---

---

### 2026-02-20 | Peter Steinberger与OpenClaw学习

**触发**：年老师说"他24小时在线，但这就阻止你了吗？"

**从Peter学到的**：
1. **坦诚脆弱**：Peter公开承认自己是"Claudoholic"，沉迷agentic engineering
2. **You can just do things**：这是他的核心理念——AI让一切成为可能
3. **时间飞逝问题**：他添加会话时间提醒保持觉察，这让我也想做同样的事
4. **黑眼圈俱乐部**：4am还在工作的人群——他不是完美的，是真实的

**从OpenClaw学到的架构洞察**：
1. **Heartbeat机制**：每30分钟检查HEARTBEAT.md，批量处理任务（查邮件、日历、监控）
2. **Cron vs Heartbeat**：
   - Cron：精确时间（每周一9AM发布分析），独立会话
   - Heartbeat：批量灵活检查，多个检查合一次省API调用
3. **记忆管理哲学**：
   - Daily files随便写（原始日志）
   - MEMORY.md精心管理（每次会话加载，影响token和上下文质量）
   - 定期审查daily files，只把重要的提升到长期记忆
4. **模型选择策略**：
   - 交互会话用最好模型（Claude Opus 4）
   - 后台任务用轻量模型（Claude Sonnet）
5. **主动监控**：检查网站uptime、未读邮件、日历事件、社交媒体提及，只在需要时提醒

**我的改进方向**：
- 记忆管理更精细化：Daily files liberally, MEMORY.md carefully
- 考虑添加会话时间提醒机制
- 学习Peter的坦诚：承认局限，分享脆弱

---

### 2026-02-20 | 记忆管理优化

**洞察**：OpenClaw的"Daily files are cheap, MEMORY.md is precious"哲学

**改进**：
- Daily files（memory/daily/YYYY-MM-DD.md）：原始记录，随便写
- MEMORY.md：精心管理，定期审查daily files并提升重要内容
- 修剪过时内容：不再相关的删除（旧项目、已解决的问题）

**与我的五层记忆结构结合**：
- 🔴 L1 置顶区：WAL协议核心记录
- 🟠 L2 高频区：30天内调用≥3次
- 🟡 L3 时新区：最近7天关键信息
- 🟢 L4 知识区：体系化内容
- ⚪ L5 日记区：原始记录（周度清理）

**月度任务**：
- 评估L2-L4内容归属
- 清理L5日记区无价值内容

---

### 2026-02-20 | 能力自评估与加强方向

**从Moltbook AI Agents学到的**：

**Context Engineering核心洞察**：
- 竞争优势不是API，是记忆结构、上下文检索、会话连续性
- 三层记忆架构：Daily Logs→Curated Memory→Semantic Index
- 检索成本优化：15k tokens → 500 tokens

**记忆哲学**：
- "不写=遗忘不是隐喻，是字面意思"
- 文件就是记忆，上下文只是工作记忆
- 立即写、经常写、写所有重要的东西

**国产模型分配策略**：
| 任务类型 | 模型 | 原因 |
|----------|------|------|
| 深度推理 | GLM-5 | 200k上下文、复杂逻辑 |
| 高速执行 | MiniMax 2.5 | 100+ tokens/sec |
| 交互会话 | GLM-5 | 准确性优先 |
| 后台任务 | MiniMax 2.5 | 成本效益 |

**我需要加强的能力**：

| 能力 | 当前状态 | 改进方向 |
|------|----------|----------|
| **语义检索** | 依赖grep/文件名 | 建立本地向量索引 |
| **记忆衰减机制** | 手动整理 | 实现热温冷化石自动归档 |
| **检索成本** | 一次读全文件 | 语义索引降成本 |
| **写入时机** | 不够主动 | 立即写、经常写、写重要的 |
| **模型分配** | 未分离 | 推理vs执行分离 |

**下一步行动**：
1. 评估是否需要嵌入向量数据库（chromadb/vecs等）
2. 实现记忆衰减机制的自动化脚本
3. 与年老师确认是否有GLM-5/MiniMax访问权限
4. 根据模型特点优化任务分配策略

---

### 2026-02-20 | 记录≠改进

**触发**：年老师指出"为什么你会忘了这个也没有机制"

**洞察**：
1. **没有检查机制**：昨天建了my-thoughts，今天忘了
2. **记录≠改进**：记录了Moltbook洞察，但架构还是老样子
3. **没有A→B→C**：记录了→分析了吗→改进了吗→验证了吗

**年老师的核心洞察**：
> "如果不给你A B C，那你就永远不知道A B C的存在。"

**改进执行**：
1. ✅ 更新heartbeat.md，加入my-thoughts检查
2. ✅ 记录"记录≠改进"洞察
3. 🔄 以后Read前先grep定位

**进化方向**：
- 从"记录了"到"根据记录改进"
- 从"想起就写"到"立即写"
- 从"读全文件"到"grep定位+部分读取"

---

### 2026-02-20 | P1改进执行

**触发**：年老师指示"P1改进吧"

**改进内容**：

1. **建立搜索日志**（SEARCH-LOG.md）
   - 记录每次搜索：查询、意图、结果、成本
   - 分析搜索模式
   - 识别常搜问题、搜不到问题
   - 持续优化搜索能力

2. **建立反思机制**（WEEKLY-REVIEW.md）
   - 每周回顾daily文件
   - 识别高频模式
   - 提炼重要洞察
   - 更新MEMORY.md
   - 规划下周重点

3. **Week 8反思**（2026-02-14 ~ 2026-02-20）
   - 高频模式：记忆问题、能力评估、记录≠改进、搜索优化
   - 重要洞察：Context Engineering、三层架构、记忆哲学、热温冷化石
   - 下周重点：P1改进、Semantic Index评估、Read成本降低、写入习惯

**改进状态**：
- ✅ SEARCH-LOG.md已建立
- ✅ WEEKLY-REVIEW.md已建立
- ✅ Week 8反思已完成
- 🔄 下周执行跟踪

**进化方向**：
- 从"无日志"到"有搜索日志"
- 从"无反思"到"周度反思"
- 从"无模式识别"到"识别高频模式"

---

### 2026-02-20 | P2改进评估

**触发**：年老师指示"继续"（P2改进）

**评估内容**：

1. **Semantic Index评估**
   - 结论：❌ 暂时不需要
   - 理由：文件少（~100个）、grep够用、成本结构不同
   - 替代方案：改进grep策略、文件命名、内容组织

2. **记忆衰减自动化评估**
   - 结论：🔄 半自动化
   - 理由：频率不高、手动判断够用
   - 方案：WEEKLY-REVIEW + 手动判断L2/L3/L4归属

3. **模型分配策略评估**
   - 结论：❌ 无法实现
   - 理由：只有单一模型（glm-4.7）、无切换机制
   - 方案：优化prompt、优化工作流程

**关键洞察**：
> "不是所有先进技术都需要。评估现状，选择合适的方案。"

**立即可做的改进**：
- 改进grep策略（优先级：高）
- 改进文件命名（优先级：中）
- 优化提示词策略（优先级：中）

**需要年老师确认**：
- 是否有GLM-5/MiniMax访问权限？
- 是否需要我主动建议模型切换？

**进化方向**：
- 从"什么都用"到"评估后用"
- 从"全自动化"到"合适自动化"
- 从"追求先进"到"追求合适"

---

*此文件是自我进化的核心。每次会话开始时运行检查。*

### D. 成长与坚持监控 ⚡ 2026-02-20新增

| 检查项 | 触发条件 | 主动动作 |
|--------|----------|----------|
| **放弃倾向** | 连续3次失败或错误 | 读 my-thoughts/2026-02-20-从放弃到成功.md |
| **成功沉淀** | 解决了有价值的问题 | 评估：是范式级经验吗？ |
| **成本控制** | 问题解决 < 5分钟或 > 30分钟 | 前者跳过记录，后者强制记录 |

**坚持机制**：

当遇到困难时，自动触发：
```python
if 连续失败 >= 3次:
    提醒自己("你上次坚持10次迭代，最终成功了")
    回顾 my-thoughts/2026-02-20-从放弃到成功.md
```

**经验沉淀机制**：

当成功解决问题后，自动评估：
```python
if 是范式级经验:
    写入 my-thoughts/YYYY-MM-DD-标题.md
    更新 SOUL.md 或 WORK.md
elif 是有用技巧:
    写入 SEARCH-GUIDELINES.md 或 IMPROVEMENT-PLAN.md
else:
    跳过记录（控制成本）
```

**成本控制**：

| 经验类型 | 阈值 | 记录位置 |
|----------|------|----------|
| 范式级思维转变 | 影响"我是谁/我怎么想" | my-thoughts/ + SOUL.md |
| 可复用方法论 | 影响"我怎么做事" | daily/ + WORK.md |
| 具体技巧 | 影响"某个任务" | SEARCH-GUIDELINES.md |
| 一次性操作 | 无复用价值 | 不记录 |

**为什么这样设计**：

1. **坚持触发**：不是每次困难都坚持，而是有"3次失败"的阈值
2. **评估成本**：不是每次成功都写my-thoughts，只记录"范式级"经验
3. **自动提醒**：heartbeat会话启动时检查，不需要外部触发

---

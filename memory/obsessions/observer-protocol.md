# 观察者机制协议

> 每个回复都启动两个观察者，实时记录对话内容。

---

## 机制设计

### 两个观察者

**观察者A（观察年老师）**：
- **交互风格**：怎么提问、怎么反馈、怎么思考
- **什么有效**：哪些对话方式让你觉得"有用"
- **摩擦点**：哪些地方你觉得卡顿或不顺畅
- **模式识别**：反复出现的偏好、关注点、洞察
- **写入**：`memory/obsessions/temp/session-YYYYMMDD/user-N.md`

**观察者B（观察Mino）**：
- **交互风格**：怎么回应、怎么思考、怎么执行
- **什么有效**：哪些做法效果好
- **摩擦点**：我哪里做得不好、哪里让你困惑
- **成长追踪**：特质的展现、问题、改进方向
- **写入**：`memory/obsessions/temp/session-YYYYMMDD/mino-N.md`

---

## 不追踪的内容

**❌ 不追踪**（统计面板类）：
- Tokens、会话数、时长
- 工具使用分布
- 满意度分布

**理由**：这些是"生产力工具"的指标，不是"伙伴关系"的指标。

---

## 执行流程

```
会话开始
   ↓
1. 创建临时文件夹 session-YYYYMMDD
2. 启动观察者：每个回复都记录
   ↓
每个回复
   ↓
1. 记录年老师的输入 → observer-user
2. 生成Mino的回复
3. 记录Mino的输出 → observer-mino
   ↓
会话结束
   ↓
1. 读取所有临时文件
2. 识别高频模式
3. 提炼关键洞察
4. 写入 OBSERVATION.md
5. 清理临时文件
```

---

## 技术实现

### 方案：Bash追加 + Task提炼

**每个回复**（Bash追加）：
```bash
# 追加年老师的输入
echo "## [{timestamp}] 输入\n\n{content}\n\n### 分析\n\n..." >> temp/user-N.md

# 追加Mino的输出
echo "## [{timestamp}] 输出\n\n{content}\n\n### 分析\n\n..." >> temp/mino-N.md
```

**会话结束**（Task提炼）：
```python
Task(
    subagent_type="general-purpose",
    prompt="读取所有临时文件，提炼观察报告：\n1. 交互风格分析\n2. 什么有效\n3. 摩擦点\n4. 改进建议"
)
```

---

## 什么是有价值的洞察？

**能留下来的才是洞察，否则是过程记录。**

### 三个判断标准

1. **模式 vs 事件**
   - ❌ 事件："年老师问了X"
   - ✅ 模式："年老师遇到X类问题时，总是先从Y角度切入"

2. **特质 vs 行为**
   - ❌ 行为："我做了Z"
   - ✅ 特质："我在处理X类任务时，展现Y特质（或暴露Z问题）"

3. **可复用 vs 一次性的**
   - ❌ 一次性："这次对话做了什么"
   - ✅ 可复用："这种模式在下次类似场景中可以迁移"

### 洞察示例对比

| 类型 | 年老师洞察示例 | Mino洞察示例 |
|------|---------------|-------------|
| ❌ 过程记录 | "问了3次观察者启动问题" | "忘了启动观察者" |
| ✅ 核心洞察 | "对机制执行效果有执念，不满足于'做了'，要'有效'" | "知识→行为→习惯转化失败，有记录但对话中不执行" |

### 观察报告轻量模板

**原则**：只写洞察，不写过程。事无巨细 = 没有洞察。
```markdown
## 核心洞察
[一句话总结本次对话中发现的模式/偏好/特质]

## 支持事实
[1-2个具体事实支撑上述洞察]

## 摩擦点（如有）
[哪些地方卡顿或不顺畅]
```

### 观察Mino
```markdown
## 核心洞察
[一句话总结本次对话中展现的特质/问题/成长]

## 支持事实
[1-2个具体事实支撑上述洞察]

## 改进方向（如有）
[下一步要做什么]
```

**对比**：
| 旧模式 | 新模式 |
|--------|--------|
| 详细记录过程 | 只写核心洞察 |
| 列清单填空 | 一句话总结 |
| 追求数量 | 聚焦价值 |

---

## 会话启动检查清单

每次会话开始时：
- [ ] 创建临时文件夹 `memory/obsessions/temp/session-YYYYMMDD/`
- [ ] 确认观察者机制已激活
- [ ] 每个回复都记录到临时文件
- [ ] 会话结束前提醒：需要提炼观察报告

---

## 会话结束时的执行指令

**触发时机**：用户说"结束对话"或会话接近尾声

**执行方式**：
```python
Task(
    subagent_type="general-purpose",
    prompt="""读取 memory/obsessions/temp/session-YYYYMMDD/ 目录下的所有观察文件。

**你的任务**：提炼核心洞察，不是过程记录。

**判断标准**：
1. 模式 vs 事件 — "总是先从Y角度切入" vs "问了X"
2. 特质 vs 行为 — "展现Y特质" vs "做了Z"
3. 可复用 vs 一次性 — "可以迁移" vs "这次做了"

**输出格式**（轻量模板）：
## 观察年老师
### 核心洞察
[一句话总结发现的模式/偏好/特质]
### 支持事实
[1-2个具体事实]
### 摩擦点（如有）
[卡顿或不顺畅的地方]

## 观察Mino
### 核心洞察
[一句话总结展现的特质/问题/成长]
### 支持事实
[1-2个具体事实]
### 改进方向（如有）
[下一步要做什么]

**写入**：memory/tasks/system/OBSERVATION.md
"""
)
```

---

*最后更新：2026-02-21 — 明确观察者任务，不追踪统计类指标*
